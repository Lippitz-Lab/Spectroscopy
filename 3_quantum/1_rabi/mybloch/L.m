function [M] = L(P)
    % Wuhan, J. Phys. B: At. Mol. Opt. Phys. 38 (2005) 827–838
    % M = 1/2*(2*A(j,i)*r*A(i,j) - A(i,j)*A(j,i)*r - r*A(i,j)*A(j,i)) ;
    
%     M1 = [ 
%           0    0    0    0    0    0    0    0    0 ;   % 00
%           0  -1/2   0    0    0    0    0    0    0 ;   % 10 
%           0    0    0    0    0    0    0    0    0 ;   % 20 
%           0    0    0  -1/2   0    0    0    0    0 ;   % 01
%           1    0    0    0   -1    0    0    0    0 ;   % 11
%           0    0    0    0    0  -1/2   0    0    0 ;   % 21 
%           0    0    0    0    0    0    0    0    0 ;   % 02
%           0    0    0    0    0    0    0  -1/2   0 ;   % 12
%           0    0    0    0    0    0    0    0    0 ;   % 22
%          ] ;
%           
%      M2 = [
%            0    0    0    0    0    0    0    0    0 ;   % 00
%            0    0    0    0    0    0    0    0    0 ;   % 10 
%            0    0  -1/2   0    0    0    0    0    0 ;   % 20 
%            0    0    0    0    0    0    0    0    0 ;   % 01
%            0    0    0    0    0    0    0    0    0 ;   % 11
%            0    0    0    0    0  -1/2   0    0    0 ;   % 21 
%            0    0    0    0    0    0  -1/2   0    0 ;   % 02
%            0    0    0    0    0    0    0  -1/2   0 ;   % 12
%            1    0    0    0    0    0    0    0   -1 ;   % 22
%          ] ;
%     
     
    g  = P.g(1,1) ;
    gs = g/2 + P.g(1,2) ;
    
     
     M1 = [ 
          0    0    0    0    g    0    0    0    0 ;   % 00
          0   -gs   0    0    0    0    0    0    0 ;   % 10 
          0    0    0    0    0    0    0    0    0 ;   % 20 
          0    0    0   -gs   0    0    0    0    0 ;   % 01
          0    0    0    0   -g    0    0    0    0 ;   % 11
          0    0    0    0    0   -gs   0    0    0 ;   % 21 
          0    0    0    0    0    0    0    0    0 ;   % 02
          0    0    0    0    0    0    0   -gs   0 ;   % 12
          0    0    0    0    0    0    0    0    0 ;   % 22
         ] ;
          
     g  = P.g(2,1) ;
     gs = g/2 + P.g(2,2) ;
     
     M2 = [
           0    0    0    0    0    0    0    0    g ;   % 00
           0    0    0    0    0    0    0    0    0 ;   % 10 
           0    0   -gs   0    0    0    0    0    0 ;   % 20 
           0    0    0    0    0    0    0    0    0 ;   % 01
           0    0    0    0    0    0    0    0    0 ;   % 11
           0    0    0    0    0   -gs   0    0    0 ;   % 21 
           0    0    0    0    0    0   -gs   0    0 ;   % 02
           0    0    0    0    0    0    0   -gs   0 ;   % 12
           0    0    0    0    0    0    0    0   -g ;   % 22
         ] ;
     
     M = M1 + M2 ;
end