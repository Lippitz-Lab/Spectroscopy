

%\renewcommand{\lastmod}{April 29, 2020}
%\renewcommand{\lastmod}{\Filemodtoday{\currfilepath}}

\chapter{Surface plasmons as example of optics of layered media}

\label{chap:tmatrix}

We investigate the optical properties of layered media, i.e., stacks of unstructured   films of material with different dielectric functions. These could be dielectric materials, leading to, e.g., Bragg reflections and dielectric filters, or metal films, leading to surface plasmons. We discuss transmission and reflection of these stacks, and the absorption and emission of quantum emitters modelled as dipoles that are situated in a plane within the layered medium. This leads to the emission pattern of a molecule near a metal or dielectric interface and the coupling of emitters to propagating surface plasmons.

This text assumes a time-dependence of the form $e^{-i \omega t}$, as usual in physics and used in \cite{Novotny-Hecht2012} or \cite{BornWolf2002}. Note, however, that this is complex-conjugate to the convention in engineering, as used in \cite{SalehTeich_2ed} and \cite{Yeh2005}.


\section{Transmission and scattering matrix}


In a layered medium, a wave travelling through the stacks of layers is  partially reflected and partially transmitted at every interface. The multiple reflections interfere with each other. To keep track of this, we use in each layer one combined wave travelling in $+z$ direction, and one travelling in $-z$ direction. At interfaces, these waves mix. This formalism is described in  chapter 7 of \cite{SalehTeich_2ed} and \cite{Yeh2005}. A similar formalism with a $E$ and $B$ field travelling in the same direction is described in \cite{Pedrotti2008} and \cite{Macleod2001}.

Let us assume that we have left of the interface a wave travelling to the right ($+z$ direction) of amplitude $U_1^+$, and one wave travelling to the left of amplitude $U_1^-$. On the right side of the interface, we get the amplitudes $U_2^\pm$ by multiplication with a \emph{transmission} or \emph{transfer} matrix $\mathbf{M}$
\begin{equation}
\begin{pmatrix}
U_2^+ \\ U_2^-
\end{pmatrix}
= 
\begin{pmatrix}
A & B \\ C & D \\
\end{pmatrix}
\cdot
\begin{pmatrix}
U_1^+ \\ U_1^-
\end{pmatrix}
%
= \mathbf{M}
\begin{pmatrix}
U_1^+ \\ U_1^-
\end{pmatrix} \label{eq:def_T_matrix}
\end{equation}
Below we will derive transmission matrices $\mathbf{M}_i$ for every interface and the homogeneous space in between. The full stack can then be described by a product matrix, multiplying together all partial matrices $\mathbf{M}_i$ along the stack
\begin{equation}
\mathbf{M}_\text{total} = \mathbf{M}_n \cdot  \mathbf{M}_{n-1} \cdots\mathbf{M}_2 \cdot  \mathbf{M}_{1}
\end{equation}
This is a very convenient feature of the transmission matrix.
Note the we label the interactions from left to right with $1$ to $n$, but the matrices are multiplied from right to left, as mathematics has it origin in Arabic culture.

An inconvenient feature of the transmission matrix is that its matrix element have no direct physical meaning. The problem is that we multiply on the matrix a vector that is half an input, half an output of this interface. We know what comes out (travels to the left), and the matrix should tell us what comes in from the other side. In this sense, the related \emph{scattering} matrix $\mathbf{S}$ is closer to physical meaning:
\begin{equation}
\begin{pmatrix}
U_2^+ \\ U_1^-
\end{pmatrix}
= 
\begin{pmatrix}
t_{12} & r_{21}  \\ r_{12} & t_{21}
\end{pmatrix}
\cdot
\begin{pmatrix}
U_1^+ \\ U_2^-
\end{pmatrix}
%
= \mathbf{S}
\begin{pmatrix}
U_1^+ \\ U_2^-
\end{pmatrix}
\end{equation}
The scattering matrix connects waves travelling towards the interface with those travelling away from the interface. The entries $t_{ij}$ and $r_{ij}$ are the transmission and reflection coefficients fro the amplitudes of the waves travelling from $i$ to $j$ (i.e. $12$ is travelling towards the right, $+z$ direction). However, for the scattering matrix $\mathbf{S}$, the full stack can not be calculated by multiplying together all partial matrices.

It is therefore convenient to switch between both representations, derive the scattering matrix $\mathbf{S}$ for each situation, and then convert into a transmission matrix $\mathbf{M}$. The relations are\sidenote{\cite{SalehTeich_2ed}  eq. 7.7}
\begin{align}
\mathbf{M} =  &
\begin{pmatrix}
A & B \\ C & D \\
\end{pmatrix}
=
\frac{1}{t_{21}}
\begin{pmatrix}
t_{12} t_{21} - r_{12}r_{21} & r_{21} \\ - r_{12} & 1 \\
\end{pmatrix} \label{eq:M_from_S}
\\
\mathbf{S} =  &
\begin{pmatrix}
t_{12} & r_{21}  \\ r_{12} & t_{21}
\end{pmatrix}
=
\frac{1}{D}
\begin{pmatrix}
AD - BC & B \\ -C & 1 \\
\end{pmatrix} \label{eq:S_from_M}
\end{align}
as long as $D$ or $t_{21}$ are not zero.


The transmission in backward direction $t_{21}$ is thus the reciprocal of the $D$-element of $\mathbf{M}_\text{total} $. The transmission in froward direction is 
\begin{equation}
t_{12} = \frac{\text{det } \mathbf{M}_\text{total} }{D}
\end{equation}
and similar for the reflection from the front side
\begin{equation}
r_{12} = - \frac{C }{D}
\end{equation}

%If a medium is loss-free, then transmitted  and reflected \emph{power} add up to one
%\begin{equation}
%|t_{12}|^2 + |r_{12}|^2 = 1 
%\quad \text{and} \quad | A|^2 - | B|^2  = 1
%\quad \text{and} \quad | \text{det } \mathbf{M} | = 1
%\end{equation}
%
%If a medium is loss-free and reciprocity holds, then the direction of travel does not matter, o.e. $t_{21} = t_{12} = t$. In this case, both matrices are described by only two complex numbers, $r$ and $t$
%\begin{equation}
%\mathbf{S} = 
%\begin{pmatrix}
%t & r \\ r & t \\
%\end{pmatrix}
%\quad
%\text{and}
%\quad 
%\mathbf{M} = 
%\begin{pmatrix}
%1/t^\star & r/t \\ r^\star / t^\star & 1/t \\
%\end{pmatrix}
%\end{equation}


\section{Electrical fields}

We need to define the physical meaning of the amplitudes $U_i^\pm$ to be able to calculate the reflection ( $r_{ij}$) and transmission ($t_{ij}$) coefficients. We assume plane waves 
\begin{equation}
\mathbf{E} \, e^{i (\mathbf{k}  \cdot \mathbf{r} - \omega t)}
=
\mathbf{\hat{E}} \, U \, e^{i \, k_z z} \, e^{i \, k_x x} \, e^{-i \omega t}
\end{equation}
where the wave vector $\mathbf{k} $ lies in the $xz$-plane, $U$ defines the amplitude of the wave and $\mathbf{\hat{E}} $  the polarization direction.
With   the full length of the wave vector in vacuum $k_0 = 2 \pi / \lambda$ and the refractive index $n$ of the medium we get
\begin{equation}
k_{z}^2 + k_{x}^2  = n^2 \, k_0^2 
\end{equation}
The polarization directions are
\begin{equation}
\mathbf{\hat{E}}^{(s)} = \begin{pmatrix}
 0 \\ 1 \\ 0 \\
\end{pmatrix}
\quad 
\text{and}
\quad
\mathbf{\hat{E}}^{(p)} =\frac{1}{n \, k_0} \begin{pmatrix}
\pm k_z \\ 0 \\  k_x  \\
\end{pmatrix}
\end{equation}
The $\pm$-sign takes the sign of the direction of travel, see Fig. 2.2 in \cite{Novotny-Hecht2012}. Note that with this definition we have $|\mathbf{\hat{E}}| = 1$, which differs from problem 12.4 in \cite{Novotny-Hecht2012}.

The left and right travelling waves are thus
\begin{equation}
\mathbf{E}^+ = \mathbf{\hat{E}} \, U^+ \, \, e^{+ i \, k_z z}
\quad
\text{and}
\quad
\mathbf{E}^- = \mathbf{\hat{E}} \, U^- \, \, e^{- i \, k_z z}
\end{equation}
where we have split off the global term $ e^{i \, ( k_x x - \omega t)}$.

\section{Propagation matrix}

Before we come to interfaces, let us discuss the transmission matrix of an homogeneous material layer $j$ of thickness $d_j$ and (complex) refractive index $n_j$. Relevant is the $z$-component of the (complex) wave vector $k_{z,j}$. Note that we do \emph{not} use the sign of  $k_{z,j}$ to describe the direction of travel.
Independent of the propagation direction, each wave sees a reflection coefficient $r=0$ and a (complex) transmission coefficient $t$
\begin{equation}
t = t_{12} = t_{21} = e^{+ i \, k_{z,j} \, d_j }
\end{equation}
The transmission matrix of an homogeneous medium is thus
\begin{equation}
\mathbf{M} = 
\begin{pmatrix}
e^{+i \, k_{z,j} \, d_j } & 0 \\0 & e^{-i \, k_{z,j} \, d_j } \\
\end{pmatrix}
\label{eq:M_prob}
\end{equation}


\section{Interface matrix}

The transmission and reflection coefficients of an interface are the Fresnel coefficients. We follow here \cite{Novotny-Hecht2012}, who follow \cite{BornWolf2002}, especially in the direction of the field vectors, see Fig. 2.2 in \cite{Novotny-Hecht2012}. In this definition,  $r^s$ and $r^p$ differ at normal incidence by a factor of $-1$. We assume non-magnetic materials ($\mu = 1$) and get for a wave travelling from medium 1 towards medium 2
\begin{align}
 r_{12}^s = & \frac{k_{z,1} - k_{z,2}}{k_{z,1} + k_{z,2}}  = - r_{21}^s\\
 t_{12}^s = & \frac{2 \, k_{z,1}}{k_{z,1} + k_{z,2}} =  \frac{k_{z,1}}{k_{z,2}}  \,  t_{21}^s\\
  r_{12}^p = & \frac{\epsilon_2	 k_{z,1} - \epsilon_1 k_{z,2}}
				  {\epsilon_2 k_{z,1} + \epsilon_1 k_{z,2}}  = - r_{21}^p\\
  t_{12}^p = & \frac{2 \sqrt{\epsilon_1 \epsilon_2}	 \,k_{z,1} }
				  {\epsilon_2 k_{z,1} + \epsilon_1 k_{z,2}}  = \frac{k_{z,1}}{k_{z,2}}  \,  t_{21}^p
\end{align}
We could also write these coefficients in terms of angle of incidence $\theta$ with
\begin{equation}
 \theta = \arcsin \frac{k_x}{n k_0} = \arcsin \sqrt{1 - \frac{k_z}{n k_0}}
\end{equation}
This would also hold in the case of evanescent waves ($k_x > n k_0$) when we allow complex angles $\theta$. We nowhere need that $\theta$ is a geometrical angle. We only need that $n \sin \theta$ is the same for all layers.


With eq.  \ref{eq:M_from_S} we get for both polarisation directions the transmission matrix
\begin{equation}
\mathbf{M}_{12} = \frac{1}{t_{21}} 
\begin{pmatrix}
1 & r_{21} \\ r_{21} & 1 \\
\end{pmatrix}
\end{equation}
as 
\begin{equation}
t_{12} t_{21} - r_{12}r_{21} = t_{21}^2 \frac{k_{z,1}}{k_{z,2}} + r_{21}^2 = 1
\end{equation}
Note that the transmission matrix from medium 1 to medium 2 uses the Fresnel coefficients of the backwards direction!
We can abbreviate this to\sidenote{In problem 12.4 in \cite{Novotny-Hecht2012} the leading $1/\eta$ seems to be missing!}
\begin{equation}
\mathbf{M}_{12} 
=\frac{ 1}{2 \eta }
\begin{pmatrix}
1 + \kappa & 1  -\kappa \\  1  - \kappa  & 1 + \kappa \\
\end{pmatrix} \label{eq:M_kappa}
\end{equation}
with 
\begin{equation}
\kappa = \eta^2 \,
\frac{  k_{z,1} }{ k_{z,2}}
\quad
\text{and}
\quad
\eta^s = 1 \quad \text{or} \quad \eta^p = \sqrt{ \frac{\epsilon_2}{\epsilon_1} }
\end{equation}
The factors $\eta$ in front of the transmission matrix $\mathbf{M}_{12} $ can be collected in front of the total transmission matrix $\mathbf{M}_\text{total}$, in case one is not interested in the distribution of the fields inside the stack. Then, all $\eta^p$ collapse into $\sqrt{\epsilon_{first} / \epsilon_{last}}$, which is equal to one in case the terminating half-spaces of the layered medium have both the same dielectric constant. 



\section{Bound modes and surface plasmons}

Which bound modes exist in a layered medium? We are interested in field distributions that decay into both surrounding half-spaces. Examples could be dielectric waveguide modes, when a material of higher index of refraction is embedded in a low-index environment, but also bound modes at metal-dielectric interfaces, so called \emph{surface plasmons}.

We can find these modes by hgoing back to our frist eqaution \ref{eq:def_T_matrix} and requiring that both incommiung field are zero, i.e. 
\begin{equation}
U_1^+ = U_2^- = 0
\end{equation}
or
\begin{equation}
\begin{pmatrix}
U_2^+ \\ 0
\end{pmatrix}
= 
\begin{pmatrix}
A & B \\ C & D \\
\end{pmatrix}
\cdot
\begin{pmatrix}
0 \\ U_1^-
\end{pmatrix}
= 
\begin{pmatrix}
B \, U_1^- \\ D \, U_1^-
\end{pmatrix}
\end{equation}
which means\sidenote{see also \cite{Yeh2005}, eq. 11.3-5, but note the different 'direction' of the matrix.} that we search for $D =0$. 


As an example, let us look at a slab of material $2$, thickness $d_2$ embedded in two half-spaces of material $1$ and $3$. The transmission matrix is
\begin{equation}
\mathbf{M}_\text{total} = \mathbf{M}_{23} \cdot \mathbf{M}_{prop} \cdot \mathbf{M}_{12}
\end{equation}
width $\delta = d_2 \, k_{z,2}$ we get
\begin{equation}
\frac{ 1}{4 \eta_{12} \eta_{23}}
\begin{pmatrix}
1 + \kappa_{23} & 1  -\kappa_{23} \\  1  - \kappa_{23}  & 1 + \kappa_{23} \\
\end{pmatrix} 
%
\begin{pmatrix}
e^{+i \delta } & 0 \\0 & e^{-i \delta } \\
\end{pmatrix}
%
\begin{pmatrix}
1 + \kappa_{12} & 1  -\kappa_{12} \\  1  - \kappa_{12}  & 1 + \kappa_{12} \\
\end{pmatrix} 
\end{equation}
The $D$ element is 
\begin{equation}
D \propto  (1 + \kappa_{12})(1 + \kappa_{23})e^{-i \delta }  +  (1 - \kappa_{12})(1 - \kappa_{23})e^{+i \delta } 
\end{equation}
$D$ becomes zero if 
\begin{equation}
\frac{  (1 + \kappa_{12})(1 + \kappa_{23})   }{ (1 - \kappa_{12})(1 - \kappa_{23})} = - e^{+i 2 \delta } 
\end{equation}
or, using $\kappa_{12} = (k_{z,1} / \epsilon_1) / (k_{z,2} / \epsilon_2)$, for p-polarization\sidenote{remove $\epsilon_i$ for s-polarization}
\begin{equation}
\frac{  k_{z,2} / \epsilon_2 + k_{z,1} / \epsilon_1   }{ k_{z,2} / \epsilon_2 - k_{z,1} / \epsilon_1} 
%
\, \,
\frac{  k_{z,2} / \epsilon_2 + k_{z,3} / \epsilon_3   }{ k_{z,2} / \epsilon_2 - k_{z,3} / \epsilon_3} 
%
=  e^{+i 2 \delta } 
\end{equation}
which agrees with \cite{Maier2007}, eq. 2.28. Note that not only the layers are labelled differently here, but also $k_z$ is defined differently. We assume $e^{i k_{z,j} \, z}$, in \cite{Maier2007} it is $e^{ k_j \, z}$, i.e. our $k_{z,j} = -i \, k_j$. However, this cancels in the equation above.

 When assuming both half-spaces are equal, i.e. $\epsilon_1 = \epsilon_3$ and $k_{z,1} = k_{z,3}$, we can simplify further\sidenote{\cite{Maier2007}, eq. 2.29}
\begin{equation}
 \left( \tanh\frac{ -i \, d \, k_{z,2}  }{2} \right)^{\pm 1} = - \frac{ \epsilon_1 \, k_{z,2}  }{ \epsilon_2 \, k_{z,1} }
\end{equation} 
Here the $-i$ difference to \cite{Maier2007} becomes relevant.
One can understand these two solutions as symmetric and anti-symmetric linear combination of modes that reside at the left ($12$)  and right ($23$) interface. They decouple when we let $d \rightarrow \infty$, so that the left side of the equation is always $1$. Using $q = k_\parallel / k_0$ and
\begin{equation}
k_{z,i} = \sqrt{k_i^2 - k_\parallel^2} = k_0 \sqrt{\epsilon_i  - q^2}
\end{equation}
we get in this case
\begin{equation}
\epsilon_2 \sqrt{\epsilon_1 - q^2} = - \epsilon_1 \sqrt{\epsilon_2 - q^2}
\end{equation}
and thus 
\begin{equation}
q  = \sqrt{\frac{\epsilon_1 \epsilon_2}{\epsilon_1 + \epsilon_2}}
\label{eq:q_interface}
\end{equation}
in agreement with \cite{Maier2007}, eq. 2.14. Often $q$ is used in the form of the mode index $\beta = q k_0 = k_\parallel$ of a waveguide mode. It describes the effective index of refraction of the mode. Its imaginary part is responsible for a decaying mode amplitude along the direction of propagation parallel to the interfaces.


\section{Lossy modes required}

We found above bound modes of the multilayer system by searching for zeros the matrix element $D$ of the transmission matrix $\mathbf{M}$. In the example of a single interface (or a very thick slab), we found with eq. \ref{eq:q_interface} a relation between the dielectric functions $\epsilon_i$ and the reduced parallel component $q_\text{bound}$ of the wave vector. For this value of $q$, the matrix element $D$ vanishes. However, in eq.\ref{eq:S_from_M} we required that $D$ would be different from zero, and we used this equation to calculate the decay rates (eq. \ref{eq:decay_single} and \ref{eq:decay_double}).
How does this fit?
%
%When using the definition of the matrix  $\mathbf{M}$  (eq. \ref{eq:def_T_matrix})  and setting $D=0$ we get 
%\begin{align}
%U_2^+ = & A U_1^+  + B U_1^- \\ 
% U_2^- = &  C  U_1^+  
%\end{align}
%The in-going fields $U_1^+$ and $U_2^-$ are decoupled from the out-going fields $U_1^-$ and $U_2^+$. This is what we required for the bound mode. It should have (decaying) out-going fields on its own, without any in-coming field.
%


One way out is the complex dielectric function $\epsilon_i$. With this, also  $q_\text{bound}$ in eq. \ref{eq:q_interface} becomes complex. The zero of $D$ does thus not occur along the real axis, which is the axis along which we integrate the decay rates eq. \ref{eq:decay_single} and \ref{eq:decay_double}.
The problem only occurs when looking at purely dielectric systems, using purely real dielectric functions. But purely real dielectric functions violate anyway the Kramers-Kronig-relation and thus causality. These should be avoided.

It is interesting to note in the complex 2D plane around  $q_\text{bound}$ the absolute value of the 
reflection coefficient $r_{21}^{(p)}$ approaches zero, which is reached  at the complex $q_\text{bound}$ of eq. \ref{eq:q_interface}. 
However, 
 $r_{21}^{(p)}$  is not continuous when approaching the real axis. Along the real axis of $q$, $r_{21}^{(p)}$ shows a maximum very close to $\Re( q_\text{bound})$. This maximum is for a metal-dielectric interface much larger than one and leads to the peak in the decay rate.\sidenote{Some analytic equitations would be nice ...}


\section{Appendix: derivation of eq. \ref{eq:M_kappa}}


We start from 
\begin{equation}
\mathbf{M}_{12} = \frac{1}{t_{21}} 
\begin{pmatrix}
1 & r_{21} \\ r_{21} & 1 \\
\end{pmatrix}
\end{equation}
and abbreviate the Fresnel coefficients as
\begin{align}
  r_{21}^s = & \frac{k_{z,2} - k_{z,1}}{k_{z,1} + k_{z,2}}  = \frac{b - a}{a + b} \\
 t_{21}^s = & \frac{2 \, k_{z,2}}{k_{z,1} + k_{z,2}} =   \frac{2 b \eta }{a + b}   \\
  r_{21}^p = & \frac{\epsilon_1	 k_{z,2} - \epsilon_2 k_{z,1}}
				  {\epsilon_2 k_{z,1} + \epsilon_1 k_{z,2}}  =   \frac{b - a}{a + b}\\
  t_{21}^p = & \frac{2 \sqrt{\epsilon_1 \epsilon_2}	 \,k_{z,2} }
				  {\epsilon_2 k_{z,1} + \epsilon_1 k_{z,2}}  =   \frac{2 b  \eta }{a + b} 
\end{align}
with $a = \epsilon_2 k_{z,1}$, $b =     \epsilon_1 k_{z,2}$ and $\eta = \sqrt{\epsilon_2 / \epsilon_1}$. In the case of s-polarization, the $\epsilon_i$ are ignored / set to one. With this we get
\begin{align}
\mathbf{M}_{12} = & \frac{a+b}{2 b \eta} 
\begin{pmatrix}
1 & (b-a)/(a+b) \\  (b-a)/(a+b) & 1 \\
\end{pmatrix}
= 
 \frac{1}{2 b \eta} 
\begin{pmatrix}
b+a & b-a \\  b-a & b+a \\
\end{pmatrix} \\
= &
 \frac{1}{2  \eta} 
\begin{pmatrix}
1+\frac{a}{b} & 1- \frac{a}{b} \\  1- \frac{a}{b} & 1+\frac{a}{b} \\
\end{pmatrix}
= 
 \frac{1}{2  \eta} 
\begin{pmatrix}
1+\kappa & 1- \kappa \\  1- \kappa & 1+\kappa \\
\end{pmatrix} \\
\end{align}
with 
\begin{equation}
\kappa = \frac{a}{b} = \eta^2 \,
\frac{  k_{z,1} }{ k_{z,2}}
\quad
\text{and}
\quad
\eta^s = 1 \quad \text{or} \quad \eta^p = \sqrt{ \frac{\epsilon_2}{\epsilon_1} }
\end{equation}


%-------------------

%\nocite{*}

\printbibliography[segment=\therefsegment,heading=subbibliography]

%\printbibliography


